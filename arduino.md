<style>
div.highlight {
    border: 1px solid lightgray;
}
code.language-plaintext {
    border: 1px solid lightgray;
}
</style>

# Программирование электросхем Ардуино (Arduino)

**Примечание:** Для удобства можно открыть данную справку в браузере. Для этого нажмите сверху-справа значок квадрата со стрелкой вверх (Открыть в браузере).

**Примечание 2:** Чтобы скопировать текст, выделите его и нажмите `CTRL+C` (C - это Copy, т.е. Копировать). Или откройте данную справку в браузере.

Содержание:
- [I. Быстрый старт](#i-быстрый-старт)
- [II. Пояснение к быстрому старту](#ii-пояснение-к-быстрому-старту)
- [III. Подробное описание быстрого старта](#iii-подробное-описание-быстрого-старта)
- [IV. Модификация быстрого старта](#iv-модификация-быстрого-старта)
- [V. Ответы для задач](#v-ответы-для-задач)

<img src="/arduino_nano.jpg" width="485" height="427" >

## I. Быстрый старт

Напишем и загрузим программу, чтобы на плате каждую секунду мигал светодиод.

1. **Подключите** плату **Arduino Nano** к компьютеру. Используйте для этого **mini USB** кабель.
2. Сверху в поле **Выбор платы** выберите порт **COM6** (номер может быть другим).
3. Появится окно **Select Other Board and Port** (Выберите другую плату и порт). В списке **BOARDS** выберите **Arduino Nano**. В списке **PORTS** выберите **COM6 Serial Port (USB)** (номер может быть другим). Нажмите **OK**.
4. Сверху выберите первую вкладку **sketch_xxxxxx.ino**, если она не была выбрана.
5. Удалите весь существующий код со страницы (**Изменить** → **Выбрать все**. **Изменить** → **Вырезать**).
6. Скопируйте код ниже и вставьте его в редактор (**Изменить** → **Вставить**):

```
void setup() {
  pinMode(13, OUTPUT);
}

void loop() {
  digitalWrite(13, HIGH);
  delay(1000);
  digitalWrite(13, LOW);
  delay(1000);
}
```
**Примечание:** чтобы скопировать, выделите текст и нажмите `CTRL+C`.<br/>
<span>7.</span> Сверху-слева нажмите кнопку **(→)** (Загрузить на плату).<br/>
<span>8.</span> **Подождите** 10 секунд. **Всё!** Первая программа была написана и загружена на плату. Теперь, если отключить плату от компьютера и подключить к USB-блокопитанию, то она будет так же мигать.

## II. Пояснение к быстрому старту

```
    Код                         Перевод                           Пояснение
                                                                  
1.  void setup() {              функция установка() {             Начинаем установку
2.    pinMode(13, OUTPUT);        контактРежим(13, ВЫХОД);          Устанавливаем для Контакта №13 режим "Выход"
3.  }                           }                                 Завершаем установку
4.                                                                
5.  void loop() {               функция цикл() {                  Начинаем циклично выполнять код
6.    digitalWrite(13, HIGH);     цифроваяЗапись(13, ВЫСОКИЙ);      Подаем на Контакт №13 высокое напряжение
7.    delay(1000);                задержка(1000);                   Ждём 1000 мс (1 сек.)
8.    digitalWrite(13, LOW);      цифроваяЗапись(13, НИЗКИЙ);       Подаем на Контакт №13 низкое напряжение
9.    delay(1000);                задержка(1000);                   Ждём 1000 мс (1 сек.)
10. }                           }                                 Переходим в начало цикла (строка 5).
```

## III. Подробное описание быстрого старта

Программа на Ардуино состоит из **двух основных функций**: `setup` (**установка**) и `loop` (**цикл**). В функции `setup` происходит **первоначальная настройка** платы. Она выполняется **один раз в начале**. Затем в функции `loop` происходит **основная работа** программы. Она выполняется **по кругу** **неограниченное количество раз**.

Содержимое функций называется **блоком**. Оно записывается **между фигурных скобок** `{` и `}`. Пример минимально возможной программы, которая ничего не делает:

```
void setup() {
  
}

void loop() {
  
}
```

Функции состоят из **команд**, которые и делают всю необходимую работу. Команды записывается как `названиеКоманды();`. Иногда нужно выполнить команду особым образом. Для этого нужно использовать **параметры**: `названиеКоманды(параметр_1, параметр_2, ...);`.

Добавим в `setup` (установка) команду установки контакта:

```
void setup() {
  pinMode(13, OUTPUT);
}

void loop() {
  
}
```

**Примечание:** чтобы скопировать, выделите текст и нажмите `CTRL+C`.

Команда `pinMode(13, OUTPUT);` (`контактРежим(13, ВЫХОД);`) читается как "Для контакта **№13** установить режим **ВЫХОД**". `pinMode` - это **название команды**, `13` - это **первый параметр** команды, а `OUTPUT` - **второй параметр**. Это значит, что мы будем работать с прибором, подключенным к 13 контакту. В Ардуино к 13 контакту подключен красный светодиод на самой плате. Мы будем **отправлять** сигнал из Ардуино на контакт №13. Поэтому мы написали **ВЫХОД**. Если мы сейчас загрузим программу, то светодиод мигать не будет. Мы только сказали плате с **каким контактом** и в **каком режиме** будем работать. Но не сказали "**Как?**".

Теперь напишем, что мы будем делать с контактом 13:

```
void setup() {
  pinMode(13, OUTPUT);
}

void loop() {
  digitalWrite(13, HIGH);
}
```

Команда `digitalWrite(13, HIGH);` (`цифроваяЗапись(13, ВЫСОКИЙ);`) читается как "Запишем (цифровым способом) для контакта **№13** высокий уровень. `digitalWrite` - это название команды, `13` - это первый параметр команды, а `HIGH` - второй параметр. Это значит, что нужно на контакт **№13** подать **высокое напряжение** (5 В).  Если мы сейчас загрузим программу, то светодиод будет непрерывно гореть.

Но мы хотим, чтобы светодиод мигал. Значит после того, как мы подали **высокое напряжение 5 В** (`HIGH`) нужно подать **низкое напряжение 0 В** (LOW). Добавим строку и получим:

```
void setup() {
  pinMode(13, OUTPUT);
}

void loop() {
  digitalWrite(13, HIGH);
  digitalWrite(13, LOW);
}
```

Если мы сейчас загрузим программу, то светодиод будет всё так же непрерывно гореть. Но почему? Мы же после подачи 5 В подаем 0 В. Почему светодиод всё равно горит? После компиляции и загрузки программы на плату она выглядит как:

```
pinMode(13, OUTPUT);
digitalWrite(13, HIGH);
digitalWrite(13, LOW);
digitalWrite(13, HIGH);
digitalWrite(13, LOW);
digitalWrite(13, HIGH);
digitalWrite(13, LOW);
...
```
Последние две команды повторяются бесконечное количество раз, т. к. они выполняются в цикле `loop`. На первый взгляд мы всё делаем правильно. Но **как долго** должен гореть светодиод? И как долго он должен быть потухший? Судя по нашей программе после того, как светодиод загорится нужно **сразу же** потушить его. А затем заново зажечь и снова сразу же потушить и т. д. Т. е. на самом деле светодиод мигает. Но он мигает **так быстро**, что человеческий глаз **не успевает заметить** это. Нужно добавить **задержку** между миганиями:

```
void setup() {
  pinMode(13, OUTPUT);
}

void loop() {
  digitalWrite(13, HIGH);
  delay(1000);
  digitalWrite(13, LOW);
  delay(1000);
}
```

Команда `delay(1000);` (`задержка(1000)`) читается как "Сделаем задержку равную 1000 мс" (1 сек).  `delay` - это **название команды**, `1000` - это **первый параметр** команды. Это значит, что нужно просто приостановить дальнейшее выполнение программы на 1 секунду. Загрузим программу. Теперь светодиод мигает.

В результате выполнение программы свободным текстом можно было бы описать как:

> Начинаем **настройку** программы. Мы будем **отправлять** сигнал на прибор, подключенный к **13 контакту**. Завершаем настройку программы.
> 
> Начинаем **непрерывное** циклическое выполнение следующих команд. Сначала на контакт **№13** подадим **высокое напряжение** (5 В). Затем **подождем** 1 секунду. После на контакт **№13** подадим **низкое напряжение** (0 В). Так же **подождем** 1 секунду. После этого вернемся к началу цикла и заново выполним команды. Команды в цикле будем выполнять бесконечное количество раз.

Итого мы полностью разобрали программу из быстрого старта.

## IV. Модификация быстрого старта

Программу можно (и нужно) изменять под свои потребности. Что делать, если мы хотим ускорить мигание светодиода? Или сделать, чтобы светодиод горел долго, а затухал быстро? Попробуйте изменять **параметры** команды и **добавлять**/**удалять** команды в существующем примере. Задачи на самостоятельное изучение:

1. Сделайте, чтобы светодиод мигал с частотой в **2 секунды**.
2. Сделайте, чтобы светодиод горел **3 секунды**, а потухшим **полсекунды**.
3. Сделайте, чтобы светодиод быстро мигал **три раза** (300 мс). А затем долго был **выключен** (5 сек).
4. Сделайте, чтобы при **подключении питания** к плате Arduino, светодиод **10 секунд** был выключен. И только **затем** начинал мигать **как обычно** (1 сек).
5. Придумайте свою задачу и сделайте для неё решение.

## V. Ответы для задач

Попытайтесь сначала решить задачи **самостоятельно**. Если сразу не получается, попробуйте **методом перебора** подобрать подходящее решение. Сделайте **перерыв** и попробуйте **снова**. Если спустя **большое количество** времени решить не удается, можно посмотреть ответ.

**Примечание:** чтобы скопировать, выделите текст и нажмите `CTRL+C`.

<span>1.</span> Сделайте, чтобы светодиод мигал с частотой в **2 секунды**.

<details>
    <summary>Посмотреть ответ для задачи 1</summary>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void setup() {
  pinMode(13, OUTPUT);
}

void loop() {
  digitalWrite(13, HIGH);
  delay(2000);
  digitalWrite(13, LOW);
  delay(2000);
}</code></pre></div></div>
</details>
<span>2.</span> Сделайте, чтобы светодиод горел **3 секунды**, а потухшим **полсекунды**.

<details>
    <summary>Посмотреть ответ для задачи 2</summary>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void setup() {
  pinMode(13, OUTPUT);
}

void loop() {
  digitalWrite(13, HIGH);
  delay(3000);
  digitalWrite(13, LOW);
  delay(500);
}</code></pre></div></div>
</details>
<span>3.</span> Сделайте, чтобы светодиод быстро мигал **три раза** (300 мс). А затем долго был **выключен** (5 сек).

<details>
    <summary>Посмотреть ответ для задачи 3</summary>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void setup() {
  pinMode(13, OUTPUT);
}

void loop() {
  digitalWrite(13, HIGH);
  delay(300);
  digitalWrite(13, LOW);
  delay(300);
  digitalWrite(13, HIGH);
  delay(300);
  digitalWrite(13, LOW);
  delay(300);
  digitalWrite(13, HIGH);
  delay(300);
  digitalWrite(13, LOW);
  delay(5000);
}</code></pre></div></div>
</details>
<span>4.</span> Сделайте, чтобы при **подключении питания** к плате Arduino, светодиод **10 секунд** был выключен. И только **затем** начинал мигать **как обычно** (1 сек).

<details>
    <summary>Посмотреть ответ для задачи 4</summary>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void setup() {
  pinMode(13, OUTPUT);
  delay(10000);
}

void loop() {
  digitalWrite(13, HIGH);
  delay(1000);
  digitalWrite(13, LOW);
  delay(1000);
}</code></pre></div></div>
</details>
